<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>Consulting Simulator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Animate.css -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
  <!-- FontAwesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"/>
  <style>
    body {
      background: linear-gradient(120deg, #f8fafc 0%, #e0e7ef 100%);
      min-height: 100vh;
      font-family: 'Segoe UI', 'Apple SD Gothic Neo', 'Malgun Gothic', Arial, sans-serif;
    }
    .hero {
      background: linear-gradient(90deg, #3b82f6 0%, #6366f1 100%);
      color: #fff;
      border-radius: 1rem;
      box-shadow: 0 4px 24px rgba(60,60,120,0.08);
      margin-bottom: 2rem;
      padding: 2.5rem 2rem 2rem 2rem;
      position: relative;
      overflow: hidden;
    }
    .hero::after {
      content: '';
      position: absolute;
      right: -80px; top: -80px;
      width: 220px; height: 220px;
      background: radial-gradient(circle, #a5b4fc 0%, #6366f1 80%, transparent 100%);
      opacity: 0.25;
      z-index: 0;
      animation: float 6s ease-in-out infinite alternate;
    }
    @keyframes float {
      0% { transform: translateY(0);}
      100% { transform: translateY(30px);}
    }
    .section-box {
      background: #fff;
      border-radius: 1.2rem;
      box-shadow: 0 2px 12px rgba(60,60,120,0.07);
      padding: 2rem 1.5rem 1.5rem 1.5rem;
      margin-bottom: 2rem;
      transition: box-shadow 0.2s, transform 0.2s;
      position: relative;
      overflow: hidden;
    }
    .section-box:hover {
      box-shadow: 0 4px 24px rgba(60,60,120,0.13);
      transform: translateY(-2px) scale(1.01);
    }
    .section-title {
      font-size: 1.25rem;
      font-weight: 700;
      margin-bottom: 1.2rem;
      color: #3b82f6;
      letter-spacing: -1px;
      display: flex;
      align-items: center;
      gap: 0.5em;
    }
    .kpi-card {
      border-radius: 1rem;
      box-shadow: 0 2px 12px rgba(60,60,120,0.06);
      transition: transform 0.2s, box-shadow 0.2s;
      background: linear-gradient(120deg, #f1f5fd 0%, #e0e7ef 100%);
      min-height: 140px;
      position: relative;
      overflow: hidden;
      cursor: pointer;
      animation: fadeInUp 1s;
    }
    .kpi-card:hover {
      transform: translateY(-4px) scale(1.04) rotate(-1deg);
      box-shadow: 0 6px 24px rgba(99,102,241,0.13);
      background: linear-gradient(120deg, #e0e7ef 0%, #f1f5fd 100%);
    }
    .kpi-label {
      font-size: 1.05rem;
      color: #6366f1;
      font-weight: 600;
      letter-spacing: -0.5px;
    }
    .kpi-value {
      font-size: 2.1rem;
      font-weight: 700;
      color: #22223b;
      margin-top: 0.2rem;
      transition: color 0.2s;
    }
    .kpi-card:hover .kpi-value {
      color: #3b82f6;
    }
    .nav-tabs .nav-link.active {
      background: #e0e7ef;
      border-bottom: 2px solid #6366f1;
      color: #3b82f6;
      font-weight: 600;
    }
    .accordion-button:not(.collapsed) {
      color: #3b82f6;
      background-color: #f1f5fd;
    }
    .dashboard-chart {
      background: #f8fafc;
      border-radius: 1rem;
      padding: 1.2rem;
      box-shadow: 0 2px 8px rgba(60,60,120,0.04);
      margin-bottom: 1.2rem;
      min-height: 120px;
      animation: fadeIn 1.2s;
    }
    .insight-list li {
      margin-bottom: 0.7rem;
      font-size: 1.05rem;
      position: relative;
      padding-left: 1.2em;
      animation: fadeInLeft 0.8s;
    }
    .insight-list li::before {
      content: "ğŸ’¡";
      position: absolute;
      left: 0;
      top: 0;
    }
    .simulator-controls label {
      font-weight: 500;
      color: #6366f1;
    }
    .simulator-controls input[type=range] {
      width: 100%;
    }
    .simulator-controls .form-range {
      accent-color: #6366f1;
    }
    .simulator-controls .form-control {
      max-width: 120px;
      display: inline-block;
    }
    .dashboard-subtitle {
      font-size: 1.07rem;
      color: #64748b;
      margin-bottom: 0.7rem;
      font-weight: 500;
      letter-spacing: -0.5px;
    }
    .dashboard-tabs .nav-link {
      font-size: 1.05rem;
      font-weight: 500;
      color: #64748b;
    }
    .dashboard-tabs .nav-link.active {
      color: #3b82f6;
      background: #e0e7ef;
    }
    .dashboard-chart .chartjs-render-monitor {
      animation: fadeIn 1.2s;
    }
    .footer {
      margin-top: 3rem;
      color: #64748b;
      font-size: 0.97rem;
      text-align: center;
    }
    .fade-in-delay-1 { animation-delay: 0.2s; }
    .fade-in-delay-2 { animation-delay: 0.4s; }
    .fade-in-delay-3 { animation-delay: 0.6s; }
    .fade-in-delay-4 { animation-delay: 0.8s; }
    @media (max-width: 768px) {
      .section-box { padding: 1.2rem 0.7rem 1rem 0.7rem; }
      .hero { padding: 1.2rem 0.7rem 1rem 0.7rem; }
      .dashboard-chart { padding: 0.5rem; }
    }
  </style>
</head>
<body>
  <div class="container py-4">
    <!-- Hero Section -->
    <div class="hero animate__animated animate__fadeInDown">
      <h1 class="display-5 fw-bold mb-2"><i class="fa-solid fa-chart-line"></i> Consulting Simulator</h1>
      <div class="fs-5 mt-2 mb-1">ë°ì´í„° ê¸°ë°˜ ì˜ì‚¬ê²°ì • &middot; KPI ë¶„ì„ &middot; ì‹œë‚˜ë¦¬ì˜¤ ì‹œë®¬ë ˆì´ì…˜</div>
      <div class="mt-2" style="font-size:1.1rem;">
        ë¹„ì¦ˆë‹ˆìŠ¤ ë°ì´í„°ë¥¼ ì—…ë¡œë“œí•˜ê³ , ì‹¤ì‹œê°„ ëŒ€ì‹œë³´ë“œì™€ ìë™ ì¸ì‚¬ì´íŠ¸ë¥¼ ê²½í—˜í•˜ì„¸ìš”.<br>
        <span class="fw-semibold">ì»¨ì„¤íŒ… ì‹œë®¬ë ˆì´í„°ëŠ” ë‹¤ì–‘í•œ ê²½ì˜ ë°ì´í„°ë¥¼ ì‹œê°í™”í•˜ê³ , ì‹œë‚˜ë¦¬ì˜¤ë³„ ê²°ê³¼ë¥¼ ì˜ˆì¸¡í•˜ì—¬<br>
        ì‹¤ì œ ì»¨ì„¤íŒ… í”„ë¡œì íŠ¸ì²˜ëŸ¼ ì „ëµì  ì˜ì‚¬ê²°ì •ì„ ì§€ì›í•©ë‹ˆë‹¤.</span>
      </div>
      <div class="mt-3">
        <ul>
          <li>ì‹¤ì œ ì»¨ì„¤íŒ…ì—ì„œ ì‚¬ìš©í•˜ëŠ” KPI ë¶„ì„, ë¹„ìš© êµ¬ì¡°, ê³ ê° ë¶„ì„, ì„±ì¥ ì˜ˆì¸¡ ë“± ë‹¤ì–‘í•œ ë¶„ì„ ê¸°ëŠ¥ ì œê³µ</li>
          <li>ì‹œë‚˜ë¦¬ì˜¤ë³„ë¡œ ì£¼ìš” ì§€í‘œê°€ ì–´ë–»ê²Œ ë³€í™”í•˜ëŠ”ì§€ ì‹¤ì‹œê°„ìœ¼ë¡œ í™•ì¸</li>
          <li>ìë™ ì¸ì‚¬ì´íŠ¸ ë° ê²½ê³ , ê°œì„  ì œì•ˆê¹Œì§€ í•œ ë²ˆì—!</li>
        </ul>
      </div>
    </div>

    <!-- 1. ë°ì´í„° íŒŒì¼ ì—…ë¡œë“œ + ë°ì´í„° êµ¬ì¡° ì•ˆë‚´ + ìƒ˜í”Œ ë‹¤ìš´ë¡œë“œ -->
    <div class="section-box animate__animated animate__fadeInUp">
      <div class="section-title"><i class="fa-solid fa-upload"></i> 1. ë°ì´í„° íŒŒì¼ ì—…ë¡œë“œ</div>
      <div class="mb-2">
        <span class="fw-semibold">ë¶„ì„í•˜ê³ ì í•˜ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ë°ì´í„°ë¥¼ ì—…ë¡œë“œí•˜ì„¸ìš”.</span><br>
        <span class="text-secondary">* CSV íŒŒì¼ë§Œ ì§€ì›í•©ë‹ˆë‹¤. (Excelì€ ë³„ë„ ì§€ì› ì˜ˆì •)</span>
      </div>
      <form>
        <div class="mb-3">
          <label for="fileInput" class="form-label">CSV íŒŒì¼ ì—…ë¡œë“œ <span class="text-secondary">(ì˜ˆ: Revenue, Cost, Employees, Customers, Inventory ë“± ì»¬ëŸ¼ í¬í•¨)</span></label>
          <input class="form-control" type="file" id="fileInput" accept=".csv">
        </div>
        <div class="form-text mb-2">
          <b>ë°ì´í„° ì˜ˆì‹œ:</b> <span class="text-secondary">Revenue, Cost, Employees, Customers, Inventory, Marketing, Product, Region, Date ë“± ë‹¤ì–‘í•œ ì»¬ëŸ¼ì„ í¬í•¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</span>
        </div>
        <div class="mb-2">
          <a href="#" class="btn btn-outline-primary btn-sm"><i class="fa-solid fa-download"></i> ìƒ˜í”Œ ë°ì´í„° ë‹¤ìš´ë¡œë“œ</a>
        </div>
        <ul class="mb-0">
          <li>íŒŒì¼ ë‚´ <b>ë‚ ì§œ, ì œí’ˆ, ì§€ì—­, ë§ˆì¼€íŒ…ë¹„, ê³ ê° ë“±</b> ë‹¤ì–‘í•œ ì»¬ëŸ¼ì„ ì¶”ê°€í•˜ë©´ ë” í’ë¶€í•œ ë¶„ì„ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.</li>
          <li>ë°ì´í„°ê°€ ì—†ì„ ê²½ìš° ìƒ˜í”Œ ë°ì´í„°ë¥¼ í™œìš©í•´ ê¸°ëŠ¥ì„ ì²´í—˜í•´ë³´ì„¸ìš”.</li>
        </ul>
      </form>
    </div>

    <!-- 2. ì‹¤ì‹œê°„ KPI ëŒ€ì‹œë³´ë“œ + ë‹¤ì–‘í•œ ëŒ€ì‹œë³´ë“œ íƒ­ + ìƒì„¸ ì„¤ëª… -->
    <div class="section-box animate__animated animate__fadeInUp">
      <div class="section-title"><i class="fa-solid fa-gauge-high"></i> 2. ì‹¤ì‹œê°„ KPI ëŒ€ì‹œë³´ë“œ</div>
      <div class="mb-2">
        <span class="fw-semibold">ì£¼ìš” ê²½ì˜ ì§€í‘œë¥¼ í•œëˆˆì— í™•ì¸í•˜ì„¸ìš”.</span><br>
        <span class="text-secondary">ì—…ë¡œë“œí•œ ë°ì´í„° ê¸°ë°˜ìœ¼ë¡œ <b>ë§¤ì¶œ, ë¹„ìš©, ROI, ì´ìµë¥ , ì§ì› ìƒì‚°ì„±</b> ë“± í•µì‹¬ KPIê°€ ìë™ ê³„ì‚°ë©ë‹ˆë‹¤.</span>
      </div>
      <div class="row g-4 mb-2">
        <div class="col-6 col-md-3">
          <div class="kpi-card text-center p-3 animate__animated animate__fadeInUp fade-in-delay-1">
            <div class="kpi-label"><i class="fa-solid fa-sack-dollar"></i> ì´ ë§¤ì¶œ</div>
            <div class="kpi-value" id="kpi-revenue">-</div>
            <div class="small text-secondary mt-1">ì „ì²´ ê¸°ê°„ ë™ì•ˆ ë°œìƒí•œ ì´ ë§¤ì¶œì•¡</div>
          </div>
        </div>
        <div class="col-6 col-md-3">
          <div class="kpi-card text-center p-3 animate__animated animate__fadeInUp fade-in-delay-2">
            <div class="kpi-label"><i class="fa-solid fa-percent"></i> ROI</div>
            <div class="kpi-value" id="kpi-roi">-</div>
            <div class="small text-secondary mt-1">íˆ¬ì ëŒ€ë¹„ ìˆ˜ìµë¥  (Return on Investment)</div>
          </div>
        </div>
        <div class="col-6 col-md-3">
          <div class="kpi-card text-center p-3 animate__animated animate__fadeInUp fade-in-delay-3">
            <div class="kpi-label"><i class="fa-solid fa-user-group"></i> ì§ì› 1ì¸ë‹¹ ë§¤ì¶œ</div>
            <div class="kpi-value" id="kpi-rev-emp">-</div>
            <div class="small text-secondary mt-1">ì§ì› í•œ ëª…ì´ ì°½ì¶œí•œ í‰ê·  ë§¤ì¶œ</div>
          </div>
        </div>
        <div class="col-6 col-md-3">
          <div class="kpi-card text-center p-3 animate__animated animate__fadeInUp fade-in-delay-4">
            <div class="kpi-label"><i class="fa-solid fa-chart-pie"></i> ì´ìµë¥ </div>
            <div class="kpi-value" id="kpi-margin">-</div>
            <div class="small text-secondary mt-1">ë§¤ì¶œ ëŒ€ë¹„ ì´ìµì˜ ë¹„ìœ¨</div>
          </div>
        </div>
      </div>
      <div class="dashboard-subtitle mt-4 mb-2"><i class="fa-solid fa-chart-bar"></i> ì£¼ìš” ëŒ€ì‹œë³´ë“œ</div>
      <div class="mb-2">
        <span class="fw-semibold">ë‹¤ì–‘í•œ ê´€ì ì—ì„œ ë°ì´í„°ë¥¼ ë¶„ì„í•˜ì„¸ìš”.</span><br>
        <span class="text-secondary">ì•„ë˜ íƒ­ì„ í´ë¦­í•˜ë©´ <b>ë§¤ì¶œ/ë¹„ìš©, ì›”ë³„ ì¶”ì´, ê³ ê°ë³„ ë¶„í¬, ì§ì› ìƒì‚°ì„±, ì¬ê³ , ë¹„ìš© êµ¬ì¡°, ê³ ê° ìœ ì§€ìœ¨</b> ë“± ë‹¤ì–‘í•œ ì‹œê°í™” ê²°ê³¼ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</span>
      </div>
      <ul class="nav nav-tabs dashboard-tabs" id="dashboardTabs" role="tablist">
        <li class="nav-item" role="presentation">
          <button class="nav-link active" id="tab1-tab" data-bs-toggle="tab" data-bs-target="#tab1" type="button" role="tab">ë§¤ì¶œ vs ë¹„ìš©</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="tab2-tab" data-bs-toggle="tab" data-bs-target="#tab2" type="button" role="tab">ì›”ë³„ ë§¤ì¶œ ì¶”ì´</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="tab3-tab" data-bs-toggle="tab" data-bs-target="#tab3" type="button" role="tab">ê³ ê°ë³„ ë§¤ì¶œ ë¶„í¬</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="tab4-tab" data-bs-toggle="tab" data-bs-target="#tab4" type="button" role="tab">ì§ì› ìƒì‚°ì„±</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="tab5-tab" data-bs-toggle="tab" data-bs-target="#tab5" type="button" role="tab">ì¬ê³  íšŒì „ìœ¨</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="tab6-tab" data-bs-toggle="tab" data-bs-target="#tab6" type="button" role="tab">ë¹„ìš© êµ¬ì¡° ë¶„ì„</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="tab7-tab" data-bs-toggle="tab" data-bs-target="#tab7" type="button" role="tab">ê³ ê° ìœ ì§€ìœ¨ ì¶”ì´</button>
        </li>
        <!-- ì¶”ê°€: ì œí’ˆë³„ ë§¤ì¶œ, ì§€ì—­ë³„ ë§¤ì¶œ, ë§ˆì¼€íŒ… íš¨ê³¼, ì„±ì¥ë¥ , ê³ ê° ì„¸ê·¸ë¨¼íŠ¸, ì œí’ˆë³„ ì´ìµë¥ , ì›”ë³„ ì‹ ê·œ ê³ ê° -->
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="tab8-tab" data-bs-toggle="tab" data-bs-target="#tab8" type="button" role="tab">ì œí’ˆë³„ ë§¤ì¶œ</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="tab9-tab" data-bs-toggle="tab" data-bs-target="#tab9" type="button" role="tab">ì§€ì—­ë³„ ë§¤ì¶œ</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="tab10-tab" data-bs-toggle="tab" data-bs-target="#tab10" type="button" role="tab">ë§ˆì¼€íŒ… íš¨ê³¼ ë¶„ì„</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="tab11-tab" data-bs-toggle="tab" data-bs-target="#tab11" type="button" role="tab">ì„±ì¥ë¥  ì¶”ì´</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="tab12-tab" data-bs-toggle="tab" data-bs-target="#tab12" type="button" role="tab">ê³ ê° ì„¸ê·¸ë¨¼íŠ¸</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="tab13-tab" data-bs-toggle="tab" data-bs-target="#tab13" type="button" role="tab">ì œí’ˆë³„ ì´ìµë¥ </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="tab14-tab" data-bs-toggle="tab" data-bs-target="#tab14" type="button" role="tab">ì›”ë³„ ì‹ ê·œ ê³ ê°</button>
        </li>
      </ul>
      <div class="tab-content dashboard-chart" id="dashboardTabsContent">
        <div class="tab-pane fade show active" id="tab1" role="tabpanel">
          <canvas id="revenueCostChart" height="90"></canvas>
          <div class="small text-secondary mt-2">ë§¤ì¶œê³¼ ë¹„ìš©ì˜ ìƒëŒ€ì  ê·œëª¨ë¥¼ ë¹„êµí•˜ì—¬ ìˆ˜ìµì„± êµ¬ì¡°ë¥¼ íŒŒì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
        </div>
        <div class="tab-pane fade" id="tab2" role="tabpanel">
          <canvas id="monthlyRevenueChart" height="90"></canvas>
          <div class="small text-secondary mt-2">ì›”ë³„ ë§¤ì¶œ ì¶”ì´ë¥¼ í†µí•´ ê³„ì ˆì„±, ì„±ì¥ íŒ¨í„´, ì´ìƒì¹˜ ë“±ì„ í™•ì¸í•˜ì„¸ìš”.</div>
        </div>
        <div class="tab-pane fade" id="tab3" role="tabpanel">
          <canvas id="customerRevenueChart" height="90"></canvas>
          <div class="small text-secondary mt-2">ê³ ê°ë³„ ë§¤ì¶œ ë¶„í¬ë¥¼ í†µí•´ í•µì‹¬ ê³ ê°êµ°ì„ íŒŒì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
        </div>
        <div class="tab-pane fade" id="tab4" role="tabpanel">
          <canvas id="employeeProductivityChart" height="90"></canvas>
          <div class="small text-secondary mt-2">ì§ì› 1ì¸ë‹¹ ë§¤ì¶œë¡œ ì¸ì  ìì›ì˜ íš¨ìœ¨ì„±ì„ ì§„ë‹¨í•˜ì„¸ìš”.</div>
        </div>
        <div class="tab-pane fade" id="tab5" role="tabpanel">
          <canvas id="inventoryTurnoverChart" height="90"></canvas>
          <div class="small text-secondary mt-2">ì¬ê³  íšŒì „ìœ¨ì´ ë†’ì„ìˆ˜ë¡ ì¬ê³  ê´€ë¦¬ê°€ íš¨ìœ¨ì ì„ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.</div>
        </div>
        <div class="tab-pane fade" id="tab6" role="tabpanel">
          <canvas id="costStructureChart" height="90"></canvas>
          <div class="small text-secondary mt-2">ë¹„ìš© êµ¬ì¡°ë¥¼ ì‹œê°í™”í•˜ì—¬ ê³ ì •ë¹„/ë³€ë™ë¹„ ë¹„ì¤‘ì„ íŒŒì•…í•˜ì„¸ìš”.</div>
        </div>
        <div class="tab-pane fade" id="tab7" role="tabpanel">
          <canvas id="retentionRateChart" height="90"></canvas>
          <div class="small text-secondary mt-2">ê³ ê° ìœ ì§€ìœ¨ ì¶”ì´ë¥¼ í†µí•´ ì¶©ì„± ê³ ê° í™•ë³´ í˜„í™©ì„ ë¶„ì„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
        </div>
        <!-- ì¶”ê°€ ëŒ€ì‹œë³´ë“œ íƒ­ -->
        <div class="tab-pane fade" id="tab8" role="tabpanel">
          <canvas id="productRevenueChart" height="90"></canvas>
          <div class="small text-secondary mt-2">ì œí’ˆë³„ ë§¤ì¶œ ë¹„ì¤‘ì„ ë¶„ì„í•˜ì—¬ ì£¼ë ¥ ìƒí’ˆì„ íŒŒì•…í•˜ì„¸ìš”.</div>
        </div>
        <div class="tab-pane fade" id="tab9" role="tabpanel">
          <canvas id="regionRevenueChart" height="90"></canvas>
          <div class="small text-secondary mt-2">ì§€ì—­ë³„ ë§¤ì¶œ ë¶„í¬ë¥¼ í†µí•´ ì‹œì¥ í™•ì¥ ì „ëµì„ ìˆ˜ë¦½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
        </div>
        <div class="tab-pane fade" id="tab10" role="tabpanel">
          <canvas id="marketingEffectChart" height="90"></canvas>
          <div class="small text-secondary mt-2">ë§ˆì¼€íŒ… ë¹„ìš© ëŒ€ë¹„ ë§¤ì¶œ íš¨ê³¼ë¥¼ ë¶„ì„í•˜ì—¬ íš¨ìœ¨ì ì¸ ì˜ˆì‚° ë°°ë¶„ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.</div>
        </div>
        <div class="tab-pane fade" id="tab11" role="tabpanel">
          <canvas id="growthRateChart" height="90"></canvas>
          <div class="small text-secondary mt-2">ê¸°ê°„ë³„ ì„±ì¥ë¥ ì„ ì‹œê°í™”í•˜ì—¬ ì„±ì¥ ë™ë ¥ì„ ì§„ë‹¨í•˜ì„¸ìš”.</div>
        </div>
        <div class="tab-pane fade" id="tab12" role="tabpanel">
          <canvas id="customerSegmentChart" height="90"></canvas>
          <div class="small text-secondary mt-2">ê³ ê° ì„¸ê·¸ë¨¼íŠ¸ë³„ ë§¤ì¶œ/ì´ìµ ê¸°ì—¬ë„ë¥¼ ë¶„ì„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
        </div>
        <div class="tab-pane fade" id="tab13" role="tabpanel">
          <canvas id="productMarginChart" height="90"></canvas>
          <div class="small text-secondary mt-2">ì œí’ˆë³„ ì´ìµë¥ ì„ ë¹„êµí•˜ì—¬ ìˆ˜ìµì„±ì´ ë†’ì€ ìƒí’ˆì„ íŒŒì•…í•˜ì„¸ìš”.</div>
        </div>
        <div class="tab-pane fade" id="tab14" role="tabpanel">
          <canvas id="newCustomerChart" height="90"></canvas>
          <div class="small text-secondary mt-2">ì›”ë³„ ì‹ ê·œ ê³ ê° ìœ ì… ì¶”ì´ë¥¼ ë¶„ì„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
        </div>
      </div>
    </div>

    <!-- 3. ì‹œë‚˜ë¦¬ì˜¤ ì‹œë®¬ë ˆì´ì…˜ + ë‹¤ì–‘í•œ ë³€ìˆ˜ + ê°€ì´ë“œ -->
    <div class="section-box animate__animated animate__fadeInUp">
      <div class="section-title"><i class="fa-solid fa-flask-vial"></i> 3. ì‹œë‚˜ë¦¬ì˜¤ ì‹œë®¬ë ˆì´ì…˜</div>
      <div class="mb-2">
        <span class="fw-semibold">ê²½ì˜ ì „ëµì„ ê°€ìƒìœ¼ë¡œ ì ìš©í•´ë³´ê³ , ì£¼ìš” ì§€í‘œê°€ ì–´ë–»ê²Œ ë³€í™”í•˜ëŠ”ì§€ ì‹¤ì‹œê°„ìœ¼ë¡œ í™•ì¸í•˜ì„¸ìš”.</span><br>
        <span class="text-secondary">ë§ˆì¼€íŒ… ì˜ˆì‚°, ì¸ì›, ê°€ê²©, ì œí’ˆ ìˆ˜, ì‹ ê·œ ê³ ê° ë“± ë‹¤ì–‘í•œ ë³€ìˆ˜ë¥¼ ì¡°ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</span>
      </div>
      <div class="row">
        <div class="col-md-5 simulator-controls">
          <label for="marketingRange" class="form-label">ë§ˆì¼€íŒ… ì˜ˆì‚° ì¦ê°€ìœ¨ (%)</label>
          <input type="range" class="form-range mb-2" min="0" max="100" step="5" id="marketingRange" value="0" oninput="document.getElementById('marketingValue').innerText=this.value">
          <span id="marketingValue" class="badge bg-primary">0</span> %
          <br>
          <label for="employeeInput" class="form-label mt-3">ì¶”ê°€ ì¸ì› ìˆ˜</label>
          <input type="number" class="form-control d-inline-block" id="employeeInput" min="0" max="20" value="0" style="width:90px;">
          <br>
          <!-- ì¶”ê°€: ê°€ê²© ì¡°ì •, ì‹ ê·œ ê³ ê° ìœ ì¹˜, ì œí’ˆ ìˆ˜ í™•ì¥ -->
          <label for="priceRange" class="form-label mt-3">ì œí’ˆ ê°€ê²© ì¡°ì • (%)</label>
          <input type="range" class="form-range mb-2" min="-20" max="20" step="2" id="priceRange" value="0" oninput="document.getElementById('priceValue').innerText=this.value">
          <span id="priceValue" class="badge bg-success">0</span> %
          <br>
          <label for="newCustomerInput" class="form-label mt-3">ì‹ ê·œ ê³ ê° ìœ ì¹˜ ìˆ˜</label>
          <input type="number" class="form-control d-inline-block" id="newCustomerInput" min="0" max="100" value="0" style="width:90px;">
          <br>
          <label for="productInput" class="form-label mt-3">ì‹ ê·œ ì œí’ˆ ì¶œì‹œ ìˆ˜</label>
          <input type="number" class="form-control d-inline-block" id="productInput" min="0" max="10" value="0" style="width:90px;">
          <div class="form-text mt-2">
            <b>Tip:</b> ì—¬ëŸ¬ ë³€ìˆ˜ë¥¼ ì¡°í•©í•˜ì—¬ ë‹¤ì–‘í•œ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‹¤í—˜í•´ë³´ì„¸ìš”.<br>
            <span class="text-secondary">ì˜ˆ) ë§ˆì¼€íŒ… ì˜ˆì‚° 20% ì¦ê°€ + ì‹ ê·œ ê³ ê° 30ëª… ìœ ì¹˜ + ê°€ê²© 5% ì¸ìƒ</span>
          </div>
        </div>
        <div class="col-md-7">
          <div class="row g-3">
            <div class="col-6 col-lg-4">
              <div class="kpi-card text-center p-2">
                <div class="kpi-label">ì‹œë®¬ë ˆì´ì…˜ ë¹„ìš©</div>
                <div class="kpi-value" id="sim-cost">-</div>
                <div class="small text-secondary">ë³€ìˆ˜ ì¡°ì • í›„ ì˜ˆìƒ ë¹„ìš©</div>
              </div>
            </div>
            <div class="col-6 col-lg-4">
              <div class="kpi-card text-center p-2">
                <div class="kpi-label">ì‹œë®¬ë ˆì´ì…˜ ROI</div>
                <div class="kpi-value" id="sim-roi">-</div>
                <div class="small text-secondary">ë³€ìˆ˜ ì¡°ì • í›„ ì˜ˆìƒ ROI</div>
              </div>
            </div>
            <div class="col-12 col-lg-4">
              <div class="kpi-card text-center p-2">
                <div class="kpi-label">ROI ë³€í™”</div>
                <div class="kpi-value" id="sim-roi-diff">-</div>
                <div class="small text-secondary">í˜„ì¬ ëŒ€ë¹„ ROI ì¦ê°</div>
              </div>
            </div>
          </div>
          <div class="dashboard-chart mt-3">
            <canvas id="roiScenarioChart" height="60"></canvas>
            <div class="small text-secondary mt-2">ì‹œë‚˜ë¦¬ì˜¤ë³„ ROI ë³€í™”ë¥¼ ì‹œê°ì ìœ¼ë¡œ ë¹„êµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
          </div>
          <!-- ì¶”ê°€: ì‹œë®¬ë ˆì´ì…˜ ê²°ê³¼ ìƒì„¸ í‘œ -->
          <div class="table-responsive mt-3">
            <table class="table table-bordered table-sm align-middle">
              <thead>
                <tr>
                  <th>ë³€ìˆ˜</th>
                  <th>í˜„ì¬ê°’</th>
                  <th>ì‹œë®¬ë ˆì´ì…˜ê°’</th>
                  <th>ì¦ê°</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>ë§¤ì¶œ</td>
                  <td id="sim-revenue-current">-</td>
                  <td id="sim-revenue-sim">-</td>
                  <td id="sim-revenue-diff">-</td>
                </tr>
                <tr>
                  <td>ë¹„ìš©</td>
                  <td id="sim-cost-current">-</td>
                  <td id="sim-cost-sim">-</td>
                  <td id="sim-cost-diff">-</td>
                </tr>
                <tr>
                  <td>ì§ì› ìˆ˜</td>
                  <td id="sim-emp-current">-</td>
                  <td id="sim-emp-sim">-</td>
                  <td id="sim-emp-diff">-</td>
                </tr>
                <tr>
                  <td>ê³ ê° ìˆ˜</td>
                  <td id="sim-cust-current">-</td>
                  <td id="sim-cust-sim">-</td>
                  <td id="sim-cust-diff">-</td>
                </tr>
                <tr>
                  <td>ì œí’ˆ ìˆ˜</td>
                  <td id="sim-prod-current">-</td>
                  <td id="sim-prod-sim">-</td>
                  <td id="sim-prod-diff">-</td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="form-text mt-2">
            <b>í™œìš© ì˜ˆì‹œ:</b> <span class="text-secondary">ì‹ ê·œ ì œí’ˆ ì¶œì‹œ, ê°€ê²© ì¸ìƒ, ë§ˆì¼€íŒ… ê°•í™” ë“± ë‹¤ì–‘í•œ ì „ëµì˜ ì¬ë¬´ì  íš¨ê³¼ë¥¼ ì‹œë®¬ë ˆì´ì…˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</span>
          </div>
        </div>
      </div>
    </div>

    <!-- 4. ìë™ ì»¨ì„¤íŒ… ì¸ì‚¬ì´íŠ¸ & ì˜ˆì¸¡ + ìƒì„¸ ì„¤ëª… + ì¶”ê°€ ì¸ì‚¬ì´íŠ¸ -->
    <div class="section-box animate__animated animate__fadeInUp">
      <div class="section-title"><i class="fa-solid fa-lightbulb"></i> 4. ìë™ ì»¨ì„¤íŒ… ì¸ì‚¬ì´íŠ¸ & ì˜ˆì¸¡</div>
      <div class="mb-2">
        <span class="fw-semibold">AI ê¸°ë°˜ìœ¼ë¡œ ì£¼ìš” ê²½ì˜ ì¸ì‚¬ì´íŠ¸ì™€ ì˜ˆì¸¡ ê²°ê³¼ë¥¼ ìë™ìœ¼ë¡œ ì œê³µí•©ë‹ˆë‹¤.</span><br>
        <span class="text-secondary">ë°ì´í„° ì—…ë¡œë“œ ë° ì‹œë‚˜ë¦¬ì˜¤ ì ìš© ì‹œ <b>ìœ„í—˜ ì‹ í˜¸, ê°œì„  ì œì•ˆ, ì„±ì¥ ê¸°íšŒ</b> ë“± ë‹¤ì–‘í•œ ì¸ì‚¬ì´íŠ¸ê°€ ìë™ ìƒì„±ë©ë‹ˆë‹¤.</span>
      </div>
      <div class="row">
        <div class="col-md-6">
          <ul class="insight-list" id="insightList">
            <li>ë°ì´í„°ë¥¼ ì—…ë¡œë“œí•˜ë©´ ìë™ ì¸ì‚¬ì´íŠ¸ê°€ í‘œì‹œë©ë‹ˆë‹¤.</li>
          </ul>
          <div class="form-text mt-2">
            <b>ì¸ì‚¬ì´íŠ¸ ì˜ˆì‹œ:</b>
            <ul>
              <li>ROIê°€ ë‚®ì„ ë•Œ ë¹„ìš© êµ¬ì¡° ê°œì„  ì œì•ˆ</li>
              <li>ê³ ê° ì´íƒˆ ì¦ê°€ ì‹œ ì¶©ì„± ê³ ê° í™•ë³´ ì „ëµ ì œì•ˆ</li>
              <li>ì œí’ˆë³„ ì´ìµë¥  ë¶„ì„ì„ í†µí•œ í¬íŠ¸í´ë¦¬ì˜¤ ìµœì í™”</li>
              <li>ë§ˆì¼€íŒ… íš¨ìœ¨ì„± ì €í•˜ ì‹œ ì˜ˆì‚° ì¬ë°°ë¶„ ê¶Œê³ </li>
              <li>ì„±ì¥ë¥  ë‘”í™” ì‹œ ì‹ ê·œ ì‹œì¥ ì§„ì¶œ ì œì•ˆ</li>
            </ul>
          </div>
        </div>
        <div class="col-md-6">
          <div class="dashboard-chart">
            <canvas id="forecastChart" height="70"></canvas>
            <div class="small text-secondary mt-2">í–¥í›„ ë§¤ì¶œ ë° ROI ì˜ˆì¸¡ ê²°ê³¼ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
          </div>
          <!-- ì¶”ê°€: ì˜ˆì¸¡ ê²°ê³¼ ìƒì„¸ í‘œ -->
          <div class="table-responsive mt-3">
            <table class="table table-bordered table-sm align-middle">
              <thead>
                <tr>
                  <th>ì˜ˆì¸¡ ê¸°ê°„</th>
                  <th>ì˜ˆìƒ ë§¤ì¶œ</th>
                  <th>ì˜ˆìƒ ROI</th>
                </tr>
              </thead>
              <tbody id="forecastTableBody">
                <tr><td colspan="3" class="text-center text-secondary">ì˜ˆì¸¡ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</td></tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!-- 5. ë°ì´í„° í…Œì´ë¸” (ì•„ì½”ë””ì–¸) + ìƒì„¸ ì„¤ëª… + í•„í„°/ê²€ìƒ‰ -->
    <div class="accordion mb-4" id="dataAccordion">
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingData">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseData" aria-expanded="false" aria-controls="collapseData">
            <i class="fa-solid fa-table"></i> ë°ì´í„° í…Œì´ë¸” ë³´ê¸°
          </button>
        </h2>
        <div id="collapseData" class="accordion-collapse collapse" aria-labelledby="headingData" data-bs-parent="#dataAccordion">
          <div class="accordion-body">
            <div class="mb-2">
              <span class="fw-semibold">ì—…ë¡œë“œí•œ ì›ë³¸ ë°ì´í„°ë¥¼ ì§ì ‘ í™•ì¸í•˜ê³ , í•„í„°ë§/ê²€ìƒ‰ ê¸°ëŠ¥ì„ í™œìš©í•´ë³´ì„¸ìš”.</span>
              <span class="text-secondary">ì»¬ëŸ¼ë³„ ì •ë ¬, í‚¤ì›Œë“œ ê²€ìƒ‰ ë“± ë‹¤ì–‘í•œ ê¸°ëŠ¥ì´ ì¶”ê°€ë  ì˜ˆì •ì…ë‹ˆë‹¤.</span>
            </div>
            <div class="table-responsive">
              <table class="table table-bordered table-sm align-middle" id="dataTable">
                <thead>
                  <tr>
                    <th>Revenue</th>
                    <th>Cost</th>
                    <th>Employees</th>
                    <th>Customers</th>
                    <th>Inventory</th>
                  </tr>
                </thead>
                <tbody>
                  <tr><td colspan="5" class="text-center text-secondary">ë°ì´í„°ë¥¼ ì—…ë¡œë“œí•˜ì„¸ìš”.</td></tr>
                </tbody>
              </table>
            </div>
            <div class="form-text mt-2">
              <b>í™œìš© íŒ:</b> <span class="text-secondary">íŠ¹ì • ê¸°ê°„, ì œí’ˆ, ì§€ì—­ ë“±ìœ¼ë¡œ ë°ì´í„°ë¥¼ í•„í„°ë§í•˜ì—¬ ì‹¬ì¸µ ë¶„ì„ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 6. ë¶„ì„ ê°€ì´ë“œ & í™œìš© ì˜ˆì‹œ -->
    <div class="section-box animate__animated animate__fadeInUp">
      <div class="section-title"><i class="fa-solid fa-book-open"></i> 5. ë¶„ì„ ê°€ì´ë“œ & í™œìš© ì˜ˆì‹œ</div>
      <div class="mb-2">
        <span class="fw-semibold">ì»¨ì„¤íŒ… ì‹œë®¬ë ˆì´í„°ë¥¼ 100% í™œìš©í•˜ëŠ” ë°©ë²•!</span>
      </div>
      <ul>
        <li><b>1ë‹¨ê³„:</b> <span class="text-secondary">CSV ë°ì´í„° ì—…ë¡œë“œ (ìƒ˜í”Œ ë°ì´í„°ë¡œë„ ì²´í—˜ ê°€ëŠ¥)</span></li>
        <li><b>2ë‹¨ê³„:</b> <span class="text-secondary">KPI ëŒ€ì‹œë³´ë“œì—ì„œ ì£¼ìš” ì§€í‘œì™€ íŠ¸ë Œë“œ í™•ì¸</span></li>
        <li><b>3ë‹¨ê³„:</b> <span class="text-secondary">ì‹œë‚˜ë¦¬ì˜¤ ì‹œë®¬ë ˆì´ì…˜ìœ¼ë¡œ ë‹¤ì–‘í•œ ì „ëµ ì‹¤í—˜</span></li>
        <li><b>4ë‹¨ê³„:</b> <span class="text-secondary">ìë™ ì¸ì‚¬ì´íŠ¸ì™€ ì˜ˆì¸¡ ê²°ê³¼ë¡œ ì „ëµì  ì˜ì‚¬ê²°ì •</span></li>
        <li><b>5ë‹¨ê³„:</b> <span class="text-secondary">ì›ë³¸ ë°ì´í„° í…Œì´ë¸”ì—ì„œ ì„¸ë¶€ ë‚´ì—­ ê²€í† </span></li>
      </ul>
      <div class="mt-2">
        <b>í™œìš© ì˜ˆì‹œ:</b>
        <ul>
          <li>ì‹ ê·œ ì œí’ˆ ì¶œì‹œ ì‹œ ì˜ˆìƒ ë§¤ì¶œ/ROI ì‹œë®¬ë ˆì´ì…˜</li>
          <li>ë§ˆì¼€íŒ… ì˜ˆì‚° ì¡°ì •ì— ë”°ë¥¸ ë¹„ìš© êµ¬ì¡° ë° ì„±ì¥ë¥  ë³€í™” ë¶„ì„</li>
          <li>ê³ ê° ì„¸ê·¸ë¨¼íŠ¸ë³„ ë§¤ì¶œ/ì´ìµë¥  ë¶„ì„ì„ í†µí•œ íƒ€ê²Ÿ ë§ˆì¼€íŒ… ì „ëµ ìˆ˜ë¦½</li>
          <li>ì§€ì—­ë³„ ë§¤ì¶œ ë°ì´í„°ë¥¼ í™œìš©í•œ ì‹œì¥ í™•ì¥ ì „ëµ ë„ì¶œ</li>
        </ul>
      </div>
      <div class="form-text mt-2">
        <b>ë¬¸ì˜/í”¼ë“œë°±:</b> <span class="text-secondary">ì¶”ê°€ ê¸°ëŠ¥ ìš”ì²­ ë° ë¬¸ì˜ëŠ” <a href="mailto:consulting@simulator.com">consulting@simulator.com</a> ìœ¼ë¡œ ì—°ë½ì£¼ì„¸ìš”.</span>
      </div>
    </div>

    <!-- Footer -->
    <div class="footer">
      &copy; 2024 Consulting Simulator &middot; All rights reserved.<br>
      <span class="text-secondary">ë³¸ ì„œë¹„ìŠ¤ëŠ” ì‹¤ì œ ì»¨ì„¤íŒ… í”„ë¡œì íŠ¸ì—ì„œ í™œìš©ë˜ëŠ” ë¶„ì„ í”„ë ˆì„ì›Œí¬ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ê°œë°œë˜ì—ˆìŠµë‹ˆë‹¤.</span>
    </div>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- PapaParse for CSV parsing -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  <script>
    // --- Chart.js chart instances ---
    let revenueCostChart, roiScenarioChart, forecastChart;
    let monthlyRevenueChart, customerRevenueChart, employeeProductivityChart, inventoryTurnoverChart;
    let costStructureChart, retentionRateChart;
    // ì¶”ê°€ ì°¨íŠ¸
    let productRevenueChart, regionRevenueChart, marketingEffectChart, growthRateChart;
    let customerSegmentChart, productMarginChart, newCustomerChart;

    // --- Helper: Format number with commas ---
    function formatNumber(num) {
      if (isNaN(num)) return '-';
      return num.toLocaleString('ko-KR');
    }
    function formatPercent(num) {
      if (isNaN(num)) return '-';
      return (num*100).toFixed(1) + '%';
    }

    // --- File Upload Handler ---
    document.getElementById('fileInput').addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (!file) return;
      const ext = file.name.split('.').pop().toLowerCase();
      if (ext === 'csv') {
        Papa.parse(file, {
          header: true,
          skipEmptyLines: true,
          complete: function(results) {
            handleData(results.data);
          }
        });
      } else {
        alert('CSV íŒŒì¼ë§Œ ì§€ì›í•©ë‹ˆë‹¤. (Excelì€ ë³„ë„ ì§€ì› ì˜ˆì •)');
      }
    });

    // --- Main Data Handler ---
    let globalData = [];
    function handleData(data) {
      // í•„ìˆ˜ ì»¬ëŸ¼ ì²´í¬ ë° ê²°ì¸¡ì¹˜ ì²˜ë¦¬
      const cols = ['Revenue','Cost','Employees','Customers','Inventory','Product','Region','Marketing','Date'];
      data = data.map(row => {
        let newRow = {};
        cols.forEach(col => {
          newRow[col] = Number(row[col]) || row[col] || 0;
        });
        return newRow;
      });
      globalData = data;
      updateTable(data);
      updateKPIs(data);
      updateCharts(data);
      updateInsights(data);
    }

    // --- Update Data Table ---
    function updateTable(data) {
      const tbody = document.querySelector('#dataTable tbody');
      tbody.innerHTML = '';
      if (!data.length) {
        tbody.innerHTML = '<tr><td colspan="5" class="text-center text-secondary">ë°ì´í„°ë¥¼ ì—…ë¡œë“œí•˜ì„¸ìš”.</td></tr>';
        return;
      }
      data.forEach(row => {
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${formatNumber(row.Revenue)}</td>
                        <td>${formatNumber(row.Cost)}</td>
                        <td>${formatNumber(row.Employees)}</td>
                        <td>${formatNumber(row.Customers)}</td>
                        <td>${formatNumber(row.Inventory)}</td>`;
        tbody.appendChild(tr);
      });
    }

    // --- Update KPI Cards ---
    function updateKPIs(data) {
      let revenue = data.reduce((a,b)=>a+Number(b.Revenue),0);
      let cost = data.reduce((a,b)=>a+Number(b.Cost),0);
      let employees = data.reduce((a,b)=>a+Number(b.Employees),0);
      let roi = cost ? (revenue-cost)/cost : 0;
      let revEmp = employees ? revenue/employees : 0;
      let margin = revenue ? (revenue-cost)/revenue : 0;

      document.getElementById('kpi-revenue').innerText = formatNumber(revenue) + ' ì›';
      document.getElementById('kpi-roi').innerText = formatPercent(roi);
      document.getElementById('kpi-rev-emp').innerText = formatNumber(revEmp) + ' ì›';
      document.getElementById('kpi-margin').innerText = formatPercent(margin);

      // ì‹œë®¬ë ˆì´ì…˜ë„ ì—…ë°ì´íŠ¸
      updateSimulation();
    }

    // --- Update Main Charts & ë‹¤ì–‘í•œ ëŒ€ì‹œë³´ë“œ ---
    function updateCharts(data) {
      // Revenue vs Cost Chart
      const labels = data.map((_,i)=>`Entry ${i+1}`);
      const revenueArr = data.map(r=>Number(r.Revenue));
      const costArr = data.map(r=>Number(r.Cost));

      if (revenueCostChart) revenueCostChart.destroy();
      const ctx1 = document.getElementById('revenueCostChart').getContext('2d');
      revenueCostChart = new Chart(ctx1, {
        type: 'bar',
        data: {
          labels: labels,
          datasets: [
            { label: 'Revenue', data: revenueArr, backgroundColor: 'rgba(59,130,246,0.7)' },
            { label: 'Cost', data: costArr, backgroundColor: 'rgba(99,102,241,0.7)' }
          ]
        },
        options: {
          responsive: true,
          plugins: { legend: { position: 'top' } },
          animation: { duration: 1200, easing: 'easeOutQuart' }
        }
      });

      // --- ì›”ë³„ ë§¤ì¶œ ì¶”ì´ (ì„ì˜ ê·¸ë£¹í•‘) ---
      if (monthlyRevenueChart) monthlyRevenueChart.destroy();
      const ctx2 = document.getElementById('monthlyRevenueChart').getContext('2d');
      let monthLabels = ['1ì›”','2ì›”','3ì›”','4ì›”','5ì›”','6ì›”'];
      let monthData = Array(monthLabels.length).fill(0);
      data.forEach((row,i)=>{
        monthData[i%monthLabels.length] += Number(row.Revenue);
      });
      monthlyRevenueChart = new Chart(ctx2, {
        type: 'line',
        data: {
          labels: monthLabels,
          datasets: [
            { label: 'ì›”ë³„ ë§¤ì¶œ', data: monthData, borderColor: '#3b82f6', backgroundColor: 'rgba(59,130,246,0.1)', tension:0.3 }
          ]
        },
        options: {
          responsive: true,
          plugins: { legend: { position: 'top' } }
        }
      });

      // --- ê³ ê°ë³„ ë§¤ì¶œ ë¶„í¬ (ì„ì˜ ë¶„í¬) ---
      if (customerRevenueChart) customerRevenueChart.destroy();
      const ctx3 = document.getElementById('customerRevenueChart').getContext('2d');
      let customerMap = {};
      data.forEach(row=>{
        let cust = row.Customers || 'ê¸°íƒ€';
        customerMap[cust] = (customerMap[cust]||0) + Number(row.Revenue);
      });
      let custLabels = Object.keys(customerMap);
      let custData = Object.values(customerMap);
      customerRevenueChart = new Chart(ctx3, {
        type: 'pie',
        data: {
          labels: custLabels,
          datasets: [
            { label: 'ê³ ê°ë³„ ë§¤ì¶œ', data: custData, backgroundColor: ['#6366f1','#3b82f6','#60a5fa','#a5b4fc','#c7d2fe','#fbbf24','#f87171'] }
          ]
        },
        options: {
          responsive: true,
          plugins: { legend: { position: 'top' } }
        }
      });

      // --- ì§ì› ìƒì‚°ì„± (ì§ì› 1ì¸ë‹¹ ë§¤ì¶œ) ---
      if (employeeProductivityChart) employeeProductivityChart.destroy();
      const ctx4 = document.getElementById('employeeProductivityChart').getContext('2d');
      let empLabels = data.map((_,i)=>`Entry ${i+1}`);
      let empData = data.map(row=>row.Employees?Number(row.Revenue)/Number(row.Employees):0);
      employeeProductivityChart = new Chart(ctx4, {
        type: 'bar',
        data: {
          labels: empLabels,
          datasets: [
            { label: 'ì§ì› 1ì¸ë‹¹ ë§¤ì¶œ', data: empData, backgroundColor: '#6366f1' }
          ]
        },
        options: {
          responsive: true,
          plugins: { legend: { position: 'top' } }
        }
      });

      // --- ì¬ê³  íšŒì „ìœ¨ (Inventory Turnover) ---
      if (inventoryTurnoverChart) inventoryTurnoverChart.destroy();
      const ctx5 = document.getElementById('inventoryTurnoverChart').getContext('2d');
      let invLabels = data.map((_,i)=>`Entry ${i+1}`);
      let invData = data.map(row=>row.Inventory?Number(row.Revenue)/Number(row.Inventory):0);
      inventoryTurnoverChart = new Chart(ctx5, {
        type: 'line',
        data: {
          labels: invLabels,
          datasets: [
            { label: 'ì¬ê³  íšŒì „ìœ¨', data: invData, borderColor: '#60a5fa', backgroundColor: 'rgba(96,165,250,0.1)', tension:0.3 }
          ]
        },
        options: {
          responsive: true,
          plugins: { legend: { position: 'top' } }
        }
      });

      // --- ë¹„ìš© êµ¬ì¡° ë¶„ì„ (Cost Structure) ---
      if (costStructureChart) costStructureChart.destroy();
      const ctx6 = document.getElementById('costStructureChart').getContext('2d');
      let totalCost = data.reduce((a,b)=>a+Number(b.Cost),0);
      let totalRevenue = data.reduce((a,b)=>a+Number(b.Revenue),0);
      let costRatio = totalRevenue ? totalCost/totalRevenue : 0;
      costStructureChart = new Chart(ctx6, {
        type: 'doughnut',
        data: {
          labels: ['ë¹„ìš©', 'ì´ìµ'],
          datasets: [{
            data: [totalCost, totalRevenue-totalCost],
            backgroundColor: ['#f87171','#34d399']
          }]
        },
        options: {
          responsive: true,
          plugins: { legend: { position: 'top' } }
        }
      });

      // --- ê³ ê° ìœ ì§€ìœ¨ ì¶”ì´ (Retention Rate) ---
      if (retentionRateChart) retentionRateChart.destroy();
      const ctx7 = document.getElementById('retentionRateChart').getContext('2d');
      let retentionLabels = ['1ë¶„ê¸°','2ë¶„ê¸°','3ë¶„ê¸°','4ë¶„ê¸°'];
      let retentionData = [100, 90, 85, 80].map((v,i)=>data.length ? (data[i%data.length].Customers/100) : 0);
      retentionRateChart = new Chart(ctx7, {
        type: 'line',
        data: {
          labels: retentionLabels,
          datasets: [
            { label: 'ê³ ê° ìœ ì§€ìœ¨', data: retentionData, borderColor: '#fbbf24', backgroundColor: 'rgba(251,191,36,0.1)', tension:0.3 }
          ]
        },
        options: {
          responsive: true,
          plugins: { legend: { position: 'top' } },
          scales: { y: { min: 0, max: 1, ticks: { callback: v=>(v*100).toFixed(0)+'%' } } }
        }
      });

      // --- ì¶”ê°€ ëŒ€ì‹œë³´ë“œ: ì œí’ˆë³„ ë§¤ì¶œ ---
      if (productRevenueChart) productRevenueChart.destroy();
      const ctx8 = document.getElementById('productRevenueChart').getContext('2d');
      let productMap = {};
      data.forEach(row=>{
        let prod = row.Product || 'ê¸°íƒ€';
        productMap[prod] = (productMap[prod]||0) + Number(row.Revenue);
      });
      let prodLabels = Object.keys(productMap);
      let prodData = Object.values(productMap);
      productRevenueChart = new Chart(ctx8, {
        type: 'bar',
        data: {
          labels: prodLabels,
          datasets: [
            { label: 'ì œí’ˆë³„ ë§¤ì¶œ', data: prodData, backgroundColor: '#a5b4fc' }
          ]
        },
        options: {
          responsive: true,
          plugins: { legend: { position: 'top' } }
        }
      });

      // --- ì¶”ê°€ ëŒ€ì‹œë³´ë“œ: ì§€ì—­ë³„ ë§¤ì¶œ ---
      if (regionRevenueChart) regionRevenueChart.destroy();
      const ctx9 = document.getElementById('regionRevenueChart').getContext('2d');
      let regionMap = {};
      data.forEach(row=>{
        let region = row.Region || 'ê¸°íƒ€';
        regionMap[region] = (regionMap[region]||0) + Number(row.Revenue);
      });
      let regionLabels = Object.keys(regionMap);
      let regionData = Object.values(regionMap);
      regionRevenueChart = new Chart(ctx9, {
        type: 'pie',
        data: {
          labels: regionLabels,
          datasets: [
            { label: 'ì§€ì—­ë³„ ë§¤ì¶œ', data: regionData, backgroundColor: ['#6366f1','#3b82f6','#60a5fa','#a5b4fc','#fbbf24','#f87171'] }
          ]
        },
        options: {
          responsive: true,
          plugins: { legend: { position: 'top' } }
        }
      });

      // --- ì¶”ê°€ ëŒ€ì‹œë³´ë“œ: ë§ˆì¼€íŒ… íš¨ê³¼ ë¶„ì„ ---
      if (marketingEffectChart) marketingEffectChart.destroy();
      const ctx10 = document.getElementById('marketingEffectChart').getContext('2d');
      let marketingArr = data.map(r=>Number(r.Marketing)||0);
      marketingEffectChart = new Chart(ctx10, {
        type: 'scatter',
        data: {
          datasets: [{
            label: 'ë§ˆì¼€íŒ…ë¹„ vs ë§¤ì¶œ',
            data: data.map(r=>({x:Number(r.Marketing)||0, y:Number(r.Revenue)||0})),
            backgroundColor: '#3b82f6'
          }]
        },
        options: {
          responsive: true,
          plugins: { legend: { position: 'top' } },
          scales: {
            x: { title: { display: true, text: 'ë§ˆì¼€íŒ…ë¹„' } },
            y: { title: { display: true, text: 'ë§¤ì¶œ' } }
          }
        }
      });

      // --- ì¶”ê°€ ëŒ€ì‹œë³´ë“œ: ì„±ì¥ë¥  ì¶”ì´ ---
      if (growthRateChart) growthRateChart.destroy();
      const ctx11 = document.getElementById('growthRateChart').getContext('2d');
      let growthData = [];
      for(let i=1;i<data.length;i++){
        let prev = Number(data[i-1].Revenue)||0;
        let curr = Number(data[i].Revenue)||0;
        growthData.push(prev?((curr-prev)/prev):0);
      }
      growthRateChart = new Chart(ctx11, {
        type: 'line',
        data: {
          labels: data.slice(1).map((_,i)=>`ê¸°ê°„${i+2}`),
          datasets: [
            { label: 'ì„±ì¥ë¥ ', data: growthData, borderColor: '#34d399', backgroundColor: 'rgba(52,211,153,0.1)', tension:0.3 }
          ]
        },
        options: {
          responsive: true,
          plugins: { legend: { position: 'top' } },
          scales: { y: { min: -1, max: 1, ticks: { callback: v=>(v*100).toFixed(0)+'%' } } }
        }
      });

      // --- ì¶”ê°€ ëŒ€ì‹œë³´ë“œ: ê³ ê° ì„¸ê·¸ë¨¼íŠ¸ ---
      if (customerSegmentChart) customerSegmentChart.destroy();
      const ctx12 = document.getElementById('customerSegmentChart').getContext('2d');
      let segMap = {};
      data.forEach(row=>{
        let seg = row.Segment || 'ê¸°íƒ€';
        segMap[seg] = (segMap[seg]||0) + Number(row.Revenue);
      });
      let segLabels = Object.keys(segMap);
      let segData = Object.values(segMap);
      customerSegmentChart = new Chart(ctx12, {
        type: 'bar',
        data: {
          labels: segLabels,
          datasets: [
            { label: 'ê³ ê° ì„¸ê·¸ë¨¼íŠ¸ë³„ ë§¤ì¶œ', data: segData, backgroundColor: '#fbbf24' }
          ]
        },
        options: {
          responsive: true,
          plugins: { legend: { position: 'top' } }
        }
      });

      // --- ì¶”ê°€ ëŒ€ì‹œë³´ë“œ: ì œí’ˆë³„ ì´ìµë¥  ---
      if (productMarginChart) productMarginChart.destroy();
      const ctx13 = document.getElementById('productMarginChart').getContext('2d');
      let prodMarginMap = {};
      data.forEach(row=>{
        let prod = row.Product || 'ê¸°íƒ€';
        let margin = Number(row.Revenue)-Number(row.Cost);
        prodMarginMap[prod] = (prodMarginMap[prod]||0) + margin;
      });
      let prodMarginLabels = Object.keys(prodMarginMap);
      let prodMarginData = Object.values(prodMarginMap);
      productMarginChart = new Chart(ctx13, {
        type: 'bar',
        data: {
          labels: prodMarginLabels,
          datasets: [
            { label: 'ì œí’ˆë³„ ì´ìµ', data: prodMarginData, backgroundColor: '#f87171' }
          ]
        },
        options: {
          responsive: true,
          plugins: { legend: { position: 'top' } }
        }
      });

      // --- ì¶”ê°€ ëŒ€ì‹œë³´ë“œ: ì›”ë³„ ì‹ ê·œ ê³ ê° ---
      if (newCustomerChart) newCustomerChart.destroy();
      const ctx14 = document.getElementById('newCustomerChart').getContext('2d');
      let newCustLabels = monthLabels;
      let newCustData = Array(monthLabels.length).fill(0);
      data.forEach((row,i)=>{
        newCustData[i%monthLabels.length] += Number(row.Customers);
      });
      newCustomerChart = new Chart(ctx14, {
        type: 'line',
        data: {
          labels: newCustLabels,
          datasets: [
            { label: 'ì›”ë³„ ì‹ ê·œ ê³ ê°', data: newCustData, borderColor: '#6366f1', backgroundColor: 'rgba(99,102,241,0.1)', tension:0.3 }
          ]
        },
        options: {
          responsive: true,
          plugins: { legend: { position: 'top' } }
        }
      });
    }

    // --- Scenario Simulation ---
    document.getElementById('marketingRange').addEventListener('input', updateSimulation);
    document.getElementById('employeeInput').addEventListener('input', updateSimulation);
    document.getElementById('priceRange').addEventListener('input', updateSimulation);
    document.getElementById('newCustomerInput').addEventListener('input', updateSimulation);
    document.getElementById('productInput').addEventListener('input', updateSimulation);

    function updateSimulation() {
      if (!globalData.length) {
        document.getElementById('sim-cost').innerText = '-';
        document.getElementById('sim-roi').innerText = '-';
        document.getElementById('sim-roi-diff').innerText = '-';
        if (roiScenarioChart) roiScenarioChart.destroy();
        updateForecast([]);
        return;
      }
      let revenue = globalData.reduce((a,b)=>a+Number(b.Revenue),0);
      let cost = globalData.reduce((a,b)=>a+Number(b.Cost),0);
      let employees = globalData.reduce((a,b)=>a+Number(b.Employees),0);

      let marketingInc = Number(document.getElementById('marketingRange').value);
      let addEmp = Number(document.getElementById('employeeInput').value);
      let priceAdj = Number(document.getElementById('priceRange').value) / 100;
      let newCust = Number(document.getElementById('newCustomerInput').value);
      let newProd = Number(document.getElementById('productInput').value);

      // ì‹œë®¬ë ˆì´ì…˜ ë§¤ì¶œ/ë¹„ìš© ê³„ì‚° (ë‹¨ìˆœ ëª¨ë¸)
      let simRevenue = revenue * (1 + marketingInc/100) + newCust * 10000;
      let simCost = cost + cost*(marketingInc/100) + addEmp*5000;
      let roi = cost ? (revenue-cost)/cost : 0;
      let simRoi = simCost ? (simRevenue-simCost)/simCost : 0;
      let roiDiff = simRoi - roi;

      document.getElementById('sim-cost').innerText = formatNumber(simCost) + ' ì›';
      document.getElementById('sim-roi').innerText = formatPercent(simRoi);
      document.getElementById('sim-roi-diff').innerText = (roiDiff>=0?'+':'') + formatPercent(roiDiff);

      // ROI Scenario Chart
      if (roiScenarioChart) roiScenarioChart.destroy();
      const ctx2 = document.getElementById('roiScenarioChart').getContext('2d');
      roiScenarioChart = new Chart(ctx2, {
        type: 'bar',
        data: {
          labels: ['í˜„ì¬ ROI', 'ì‹œë®¬ë ˆì´ì…˜ ROI'],
          datasets: [{
            label: 'ROI',
            data: [roi, simRoi],
            backgroundColor: ['#6366f1','#3b82f6']
          }]
        },
        options: {
          indexAxis: 'y',
          plugins: { legend: { display: false } },
          scales: { x: { min: -1, max: 1, ticks: { callback: v=>(v*100).toFixed(0)+'%' } } }
        }
      });

      // Forecastë„ ì—…ë°ì´íŠ¸
      updateForecast([revenue, simCost]);
      updateInsights(globalData, roi, simRoi, marketingInc, employees, revenue);
    }

    // --- Forecast Chart ---
    function updateForecast([revenue, simCost]) {
      if (!revenue || !simCost) {
        if (forecastChart) forecastChart.destroy();
        return;
      }
      let periods = 3;
      let revenueForecast = Array.from({length:periods}, (_,i)=>revenue*(1+0.05*(i+1)));
      let roiForecast = revenueForecast.map(rf=>(rf-simCost)/simCost);

      if (forecastChart) forecastChart.destroy();
      const ctx3 = document.getElementById('forecastChart').getContext('2d');
      forecastChart = new Chart(ctx3, {
        type: 'line',
        data: {
          labels: ['Period 1','Period 2','Period 3'],
          datasets: [
            { label: 'Revenue Forecast', data: revenueForecast, borderColor: '#3b82f6', backgroundColor: 'rgba(59,130,246,0.1)', yAxisID:'y' },
            { label: 'ROI Forecast', data: roiForecast, borderColor: '#6366f1', backgroundColor: 'rgba(99,102,241,0.1)', yAxisID:'y1' }
          ]
        },
        options: {
          responsive: true,
          plugins: { legend: { position: 'top' } },
          scales: {
            y: { type:'linear', position:'left', title:{display:true,text:'Revenue'} },
            y1: { type:'linear', position:'right', title:{display:true,text:'ROI'}, min:-1, max:1, ticks:{callback:v=>(v*100).toFixed(0)+'%'} }
          }
        }
      });
    }

    // --- Automated Insights ---
    function updateInsights(data, roi, simRoi, marketingInc, employees, revenue) {
      const ul = document.getElementById('insightList');
      ul.innerHTML = '';
      if (!data.length) {
        ul.innerHTML = '<li>ë°ì´í„°ë¥¼ ì—…ë¡œë“œí•˜ë©´ ìë™ ì¸ì‚¬ì´íŠ¸ê°€ í‘œì‹œë©ë‹ˆë‹¤.</li>';
        return;
      }
      let revEmp = employees ? revenue/employees : 0;
      let margin = revenue ? (revenue-data.reduce((a,b)=>a+b.Cost,0))/revenue : 0;
      let insights = [];
      if (roi < 0.1) insights.push('ROIê°€ 10% ë¯¸ë§Œì…ë‹ˆë‹¤. ë¹„ìš© ìµœì í™” ë˜ëŠ” íš¨ìœ¨ì„± ê°œì„ ì„ ê¶Œì¥í•©ë‹ˆë‹¤.');
      if (revEmp < 50000) insights.push('ì§ì› 1ì¸ë‹¹ ë§¤ì¶œì´ ë‚®ìŠµë‹ˆë‹¤. ì—…ë¬´ í”„ë¡œì„¸ìŠ¤ ê°œì„  ë˜ëŠ” êµìœ¡ì„ ê³ ë ¤í•˜ì„¸ìš”.');
      if (marketingInc > 20) insights.push('ë§ˆì¼€íŒ… ì˜ˆì‚°ì´ ê³¼ë„í•˜ê²Œ ì¦ê°€í–ˆìŠµë‹ˆë‹¤. ê¸°ëŒ€ ë§¤ì¶œ ì¦ê°€ì™€ì˜ ì •í•©ì„±ì„ ê²€í† í•˜ì„¸ìš”.');
      if (margin < 0.15) insights.push('ì´ìµë¥ ì´ 15% ë¯¸ë§Œì…ë‹ˆë‹¤. ê°€ê²© ì •ì±… ë˜ëŠ” ë³€ë™ë¹„ ì ˆê°ì„ ê²€í† í•˜ì„¸ìš”.');
      if (simRoi > roi) insights.push('ì‹œë®¬ë ˆì´ì…˜ ê²°ê³¼ ROIê°€ ê°œì„ ë©ë‹ˆë‹¤. ë³€ê²½ì•ˆì˜ ì‹¤í–‰ ê°€ëŠ¥ì„±ì„ ê²€í† í•˜ì„¸ìš”.');
      if (!insights.length) insights.push('ëª¨ë“  ì£¼ìš” ì§€í‘œê°€ ì–‘í˜¸í•©ë‹ˆë‹¤. í˜„ì¬ ì „ëµì„ ìœ ì§€í•˜ì„¸ìš”.');
      insights.forEach(txt=>{
        const li = document.createElement('li');
        li.innerText = txt;
        ul.appendChild(li);
      });
    }
  </script>
</body>
</html>